/*!
 * uiGlide v1.0.0
 * http://uiglide.com
 *
 * Copyright WCP Digital and Patrick Purcell
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 * Date: 2016-07-25
 */
"use strict";!function(t){function e(e){var n=this,o="1.0.0",r=[],l=0,i=null,s=[],a="",u=!1,c=!1,d=null,f=null,p=null,h=null,g=null,m=null,x=null,B=null,v=null,y=null,w=null,b=null,S=null,C={parent:document.body||null,steps:[],defaultSet:"uiGlide",transition:500,fadeIn:1e3,fadeOut:500,minWidth:220,minHeight:125,padding:10,borderWidth:2,documentPadding:20,passthrough:!0,dataUISet:"data-uigset",dataUIStep:"data-uigstep",dataUITitle:"data-uigtitle",dataUIDesc:"data-uigdesc",dataUIHtml:"data-uightml",dataUIPassthrough:"data-uigpassthrough",cssLeftBox:"uig-box uig-box-left",cssRightBox:"uig-box uig-box-right",cssTopBox:"uig-box uig-box-top",cssBottomBox:"uig-box uig-box-bottom",cssFocusBox:"uig-focusbox",cssFocusBoxLeft:"uig-focusbox-left",cssFocusBoxRight:"uig-focusbox-right",cssFocusBoxTop:"uig-focusbox-top",cssFocusBoxBottom:"uig-focusbox-bottom",cssFocusContent:"uig-focus-content",cssTitleBox:"uig-titlebox",cssDescBox:"uig-descbox",cssPrevBtn:"uig-btn uig-btn-prev",cssNextBtn:"uig-btn uig-btn-next",cssCloseBtn:"uig-btn uig-btn-close",htmlPrevBtn:'<a href="javascript:void(0)">&lt;</a>',htmlNextBtn:'<a href="javascript:void(0)">&gt;</a>',htmlCloseBtn:'<a href="javascript:void(0)">&#10006;</a>',htmlFocusContent:"<div></div>",onBeforeOpen:null,onAfterOpen:null,onBeforeClose:null,onAfterClose:null,onBeforeGoto:null,onAfterGoto:null,onBeforeStep:null,onAfterStep:null,onStep:null},I=function(){return"ontouchstart"in window||navigator.maxTouchPoints},T=function(t,e,n){return t+n*(e-t)},E=function(t,e){t.style.opacity=e;var n=100*e;t.style.filter="alpha(opacity="+n+")"},M=function(t,e,n){var o=60,r=0,l=Date.now(),i=1e3/o,s=e,a=0,u=0,c=setInterval(function(){return a=u/s,a>=1?(t(1),clearInterval(c),n&&n()):(t(a),r=Math.floor(1/(.001*(Date.now()-l))),l=Date.now(),void(u+=i*(o/r)))},i);return c},F=function(t){var e=n.document,o=n.window,r=0,l=0;return t!==e.body&&t!==e.documentElement?(r=t.scrollLeft,l=t.scrollTop):(r=o.scrollX||o.pageXOffset||e.documentElement.scrollLeft,l=o.scrollY||o.pageYOffset||e.documentElement.scrollTop),{left:r,top:l}},L=function(){var t=n.document.body,e=n.document.documentElement,o=Math.max(t.scrollWidth,t.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),r=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);return{width:o,height:r,left:0,top:0}},N=function(t){var e=n.document,o=n.window,r=t.getBoundingClientRect(),l=r.left+(o.scrollX||o.pageXOffset||e.documentElement.scrollLeft),i=r.top+(o.scrollY||o.pageYOffset||e.documentElement.scrollTop),s=r.right-r.left,a=r.bottom-r.top,u=l+.5*s,c=i+.5*a;return{left:l,top:i,width:s,height:a,center:{left:u,top:c}}},A=function(t,e){var o=n.document;n.window;if(e==o.body||e==o.documentElement)return N(t);var r=F(e),l=e.getBoundingClientRect(),i=t.getBoundingClientRect(),s=i.left-l.left+r.left,a=i.top-l.top+r.top,u=i.right-i.left,c=i.bottom-i.top,d=s+.5*u,f=a+.5*c;return{left:s,top:a,width:u,height:c,center:{left:d,top:f}}},D=function(){var t=n.document.createElement("DIV");return t.style.position="absolute",t.style.display="block",t.style.width="0px",t.style.height="0px",t.style.left="0px",t.style.top="0px",t},G=function(){k(l+1)},H=function(){k(l-1)},k=function(t){var e=n.document;n.window;if(C&&C.onBeforeGoto&&C.onBeforeGoto(n),d&&P(),(isNaN(t)||void 0===s[t])&&(t=0),i&&i.onAfterStep&&i.onAfterStep(n),i=s[t]||null,l=t,!i||!i.element)throw new Error("uiGlide: Step not found: Set: "+s+", Index: "+l);i&&i.onBeforeStep&&i.onBeforeStep(n),i&&i.title?(g.style.display="block",g.innerHTML=i.title):g.style.display="none",i&&i.desc?(m.style.display="block",m.innerHTML=i.desc):m.style.display="none",i&&i.html?(h.style.display="block",h.innerHTML=i.html):h.style.display="none",i.passthrough?(p.style.pointerEvents="none",x.style.pointerEvents="auto",B.style.pointerEvents="auto",v.style.pointerEvents="auto"):p.style.pointerEvents="auto",0>=t?x.style.display="none":x.style.display="block",t>=s.length-1?B.style.display="none":B.style.display="block";var o=A(p,C.parent),r=(parseInt(p.style.width,10),parseInt(p.style.height,10),parseInt(p.style.left,10),parseInt(p.style.top,10),F(C.parent));return R(),d=M(function(t){var n=i.element.offsetLeft-C.documentPadding,l=i.element.offsetTop-C.documentPadding,s=T(r.left,n,t),a=T(r.top,l,t);C.parent&&C.parent!=e.body&&C.parent!=e.documentElement?(C.parent.scrollLeft=s,C.parent.scrollTop=a):(e.body.scrollLeft=s,e.body.scrollTop=a,e.documentElement.scrollLeft=s,e.documentElement.scrollTop=a);var u=A(i.element,C.parent),c=Math.max(u.width,C.minWidth)+2*C.padding,d=Math.max(u.height,C.minHeight)+2*C.padding,f=u.center.left-.5*c,p=u.center.top-.5*d,h=L(),g=h.left+C.documentPadding,m=h.left+h.width-C.documentPadding,x=h.top+C.documentPadding,B=h.top+h.height-C.documentPadding;g>f?f=g:f+c>m&&(f-=f+c-m),x>p?p=x:p+d>B&&(p-=p+d-B);var v=T(o.width,c,t),y=T(o.height,d,t),w=T(o.left,f,t),b=T(o.top,p,t);O(w,b,v,y)},C.transition,function(){P(),W(),i&&i.onStep&&i.onStep(n),C&&C.onAfterGoto&&C.onAfterGoto(n)}),n},P=function(){return clearInterval(d),d=null,n},U=function(t,e,n,o,r,l,i){t.style.width=e,t.style.height=n,t.style.left=o,t.style.top=r,t.style.right=l,t.style.bottom=i},O=function(t,e,n,o){var r=n,l=o,i=t,s=e,a=L();U(p,Math.max(r-2*C.borderWidth,0)+"px",Math.max(l-2*C.borderWidth,0)+"px",i+"px",s+"px","auto","auto"),p.style.borderWidth=C.borderWidth+"px",U(y,Math.max(i,0)+"px",Math.max(a.height,0)+"px","0px","0px","auto","auto"),U(w,"auto",Math.max(a.height,0)+"px",i+r+"px","0px","0px","auto"),U(b,Math.max(r,0)+"px",Math.max(s,0)+"px",i+"px","0px","auto","auto"),U(S,Math.max(r,0)+"px",Math.max(a.height-(s+l),0)+"px",i+"px",s+l+"px","auto","auto")},W=function(){var e=A(p,C.parent),n=L(),o=e.top-n.top,r=n.top+n.height-(e.top+e.height),l=e.left-n.left,i=n.left+n.width-(e.left+e.width);r>=o?t(p).addClass(C.cssFocusBoxTop):t(p).addClass(C.cssFocusBoxBottom),i>=l?t(p).addClass(C.cssFocusBoxLeft):t(p).addClass(C.cssFocusBoxRight)},R=function(){for(var e=[C.cssFocusBoxLeft,C.cssFocusBoxRight,C.cssFocusBoxTop,C.cssFocusBoxBottom],n=0,o=e.length;o>n;n++)t(p).removeClass(e[n])},V=function(){if(t(n.window).off("orientationchange",et),t(n.window).off("resize",et),t(C.parent).off("orientationchange",et),t(C.parent).off("resize",et),t(x).off("click",$),t(x).off("touchstart",$),t(B).off("click",_),t(B).off("touchstart",_),t(v).off("click",tt),t(v).off("touchstart",tt),!I())for(var e=[y,w,b,S],o=0,r=e.length;r>o;o++)t(e[o]).off("click",tt),t(e[o]).off("touchstart",tt);for(var l=[v,B,x,m,g,p,y,w,b,S],o=l.length-1;o>=0;o--)t(l[o]).remove(),l[o]=null;C&&C.onAfterClose&&C.onAfterClose(n),c=!1},Y=function(){if(u)throw new Error("uiGlide: Tried to close before completing the opening.");c=!0,C&&C.onBeforeClose&&C.onBeforeClose(n),d&&P();var t=[p,y,w,b,S];return M(function(e){e=1-e;for(var n=t.length-1;n>=0;n--)E(t[n],e)},C.fadeOut,V),n},j=function(t){a=t||r[0].set||C.defaultSet,s=[];for(var e=0,n=r.length;n>e;e++)r[e].set==a&&s.push(r[e]);if(0==s.length)throw new Error("uiGlide: This set is empty or doesn't exist.");return K(s)},z=function(){if(p=D(),p.className=C.cssFocusBox,C.parent.appendChild(p),h=n.document.createElement("DIV"),h.innerHTML=C.htmlFocusContent,h.className=C.cssFocusContent,p.appendChild(h),g=n.document.createElement("DIV"),g.className=C.cssTitleBox,p.appendChild(g),m=n.document.createElement("DIV"),m.className=C.cssDescBox,p.appendChild(m),x=n.document.createElement("DIV"),x.className=C.cssPrevBtn,x.innerHTML=C.htmlPrevBtn,p.appendChild(x),B=n.document.createElement("DIV"),B.className=C.cssNextBtn,B.innerHTML=C.htmlNextBtn,p.appendChild(B),v=n.document.createElement("DIV"),v.className=C.cssCloseBtn,v.innerHTML=C.htmlCloseBtn,p.appendChild(v),t(x).on("click",$),t(x).on("touchstart",$),t(B).on("click",_),t(B).on("touchstart",_),t(v).on("click",tt),t(v).on("touchstart",tt),y=D(),y.className=C.cssLeftBox,C.parent.appendChild(y),w=D(),w.className=C.cssRightBox,C.parent.appendChild(w),b=D(),b.className=C.cssTopBox,C.parent.appendChild(b),S=D(),S.className=C.cssBottomBox,C.parent.appendChild(S),!I())for(var e=[y,w,b,S],o=0,r=e.length;r>o;o++)t(e[o]).on("click",tt),t(e[o]).on("touchstart",tt);t(C.parent).on("orientationchange",et),t(C.parent).on("resize",et),t(n.window).on("orientationchange",et),t(n.window).on("resize",et);var l=L(),i=200,s=200,a=.5*l.width-i,u=100;O(a,u,i,s)},X=function(t,e){if(c)throw new Error("uiGlide: Tried to open before completing the close.");if(p)throw new Error("uiGlide: You can only open one glide at a time.");u=!0,C&&C.onBeforeOpen&&C.onBeforeOpen(n),z(),M(function(t){E(p,t)},C.fadeIn);var o=[y,w,b,S];return M(function(t){for(var e=o.length-1;e>=0;e--)E(o[e],t)},1.5*C.fadeIn),C&&C.onAfterOpen&&C.onAfterOpen(n),j(t),u=!1,k(e)},Q=function(){for(var e=[],o=t("["+C.dataUIStep+"]",C.parent),r=0,l=o.length,i=0,s=null,a="",u="",c="",d=null;l>r;r++)i=parseInt(t(o[r]).attr(C.dataUIStep),10),s=t(o[r]).attr(C.dataUISet),a=t(o[r]).attr(C.dataUITitle),u=t(o[r]).attr(C.dataUIDesc),c=t(o[r]).attr(C.dataUIHtml),d=t(o[r]).attr(C.dataUIPassthrough),e.push({index:i,element:o[r],set:s||C.defaultSet,title:a,desc:u,html:c,passthrough:d||C.passthrough,onBeforeStep:C.onBeforeStep,onAfterStep:C.onAfterStep,onStep:C.onStep,uiGlide:n});return e},q=function(t){for(var e=0,n=t.length;n>e;e++)t.index=e,t.set||(t.set=C.defaultSet),(void 0===t.passthrough||null===t.passthrough)&&(t.passthrough=C.passthrough),t.onBeforeStep||(t.onBeforeStep=C.onBeforeStep),t.onAfterStep||(t.onAfterStep=C.onAfterStep),t.onStep||(t.onStep=C.onStep);return t},J=function(t){return t.sort(function(t,e){return t.set==e.set?0:+(t.set>e.set)||-1}),t},K=function(t){return t.sort(function(t,e){return t.index==e.index?0:+(t.index>e.index)||-1}),t},Z=function(e,n){for(var o=0,r=e.length;r>o;o++)n[o]&&(e[o]?e[o]=t.extend({},e[o],n[o]):e[o]=n[o]);for(var o=0,r=n.length;r>o;o++)!e[o]&&n[o]&&(e[o]=n[o]);return t.grep(e,function(t,e){return void 0!=t&&null!=t})},$=function(t){t.preventDefault(),H()},_=function(t){t.preventDefault(),G()},tt=function(t){t.preventDefault(),Y()},et=function(t){clearTimeout(f),f=setTimeout(function(){k(l)},250)},nt=function(){if(e&&(C=t.extend({},C,e),C.parent=C.parent||document.body,n.window=e.window||window,n.document=e.document||document),!C.parent||!C.parent.appendChild)throw new Error("uiGlide: Cannot append elements to the settings.parent element.");var o=Q(),l=q(C.steps);r=Z(o,l),r=J(r)};n.open=X,n.close=Y,n.next=G,n.prev=H,n["goto"]=k,n.stop=P,n.getFocusBox=function(){return p},n.getSettings=function(){return C},n.getSteps=function(){return s},n.getStep=function(t){return s[t]||null},n.getCurrentSet=function(){return s},n.getCurrentSetName=function(){return a},n.getCurrentStep=function(){return i},n.getCurrentStepIndex=function(){return l},n.getVersion=function(){return o},n.window=window,n.document=document,nt()}t.uiGlide=function(t){return new e(t)},t.fn.uiGlide=function(n){return n.parent=t(this)[0]||null,new e(n)}}(jQuery);