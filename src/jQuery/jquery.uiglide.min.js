/*!
 * uiGlide v1.0.0
 * http://uiglide.com
 *
 * Copyright WCP Digital and Patrick Purcell
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 * Date: 2016-07-25
 */
"use strict";!function(t){t.fn.uiGlide=function(e){var o=this,n="1.0.0",l=[],s=0,i=null,r=[],a="",u=!1,c=null,d=null,f=null,p=null,h=null,m=null,g=null,x=null,y=null,B=null,v=null,w=null,b={parent:document.body||null,steps:[],defaultSet:"uiGlide",transition:500,fadeIn:1e3,fadeOut:500,minWidth:260,minHeight:125,padding:10,borderWidth:2,documentPadding:20,passthrough:!0,dataUISet:"data-uigset",dataUIStep:"data-uigstep",dataUITitle:"data-uigtitle",dataUIDesc:"data-uigdesc",dataUIHtml:"data-uightml",dataUIPassthrough:"data-uigpassthrough",cssLeftBox:"uig-box uig-box-left",cssRightBox:"uig-box uig-box-right",cssTopBox:"uig-box uig-box-top",cssBottomBox:"uig-box uig-box-bottom",cssFocusBox:"uig-focusbox",cssFocusBoxLeft:"uig-focusbox-left",cssFocusBoxRight:"uig-focusbox-right",cssFocusBoxTop:"uig-focusbox-top",cssFocusBoxBottom:"uig-focusbox-bottom",cssFocusContent:"uig-focus-content",cssTitleBox:"uig-titlebox",cssDescBox:"uig-descbox",cssPrevBtn:"uig-btn uig-btn-prev",cssNextBtn:"uig-btn uig-btn-next",cssCloseBtn:"uig-btn uig-btn-close",htmlPrevBtn:'<a href="javascript:void(0)">&lt;</a>',htmlNextBtn:'<a href="javascript:void(0)">&gt;</a>',htmlCloseBtn:'<a href="javascript:void(0)">&#10006;</a>',htmlFocusContent:"<div></div>",onBeforeOpen:null,onAfterOpen:null,onBeforeClose:null,onAfterClose:null,onBeforeGoto:null,onAfterGoto:null,onBeforeStep:null,onAfterStep:null,onStep:null},S=function(){return"ontouchstart"in window||navigator.maxTouchPoints},C=function(t,e,o){return t+o*(e-t)},I=function(t,e){t.style.opacity=e;var o=100*e;t.style.filter="alpha(opacity="+o+")"},T=function(t,e,n,l){var s=o.document;l=l||0;var i=M(t),r=(e||0)-i.left,a=(n||0)-i.top;E(function(e){t&&t!=s.body&&t!=s.documentElement?(t.scrollLeft=i.left+r*e,t.scrollTop=i.top+a*e):(s.body.scrollLeft=i.left+r*e,s.body.scrollTop=i.top+a*e,s.documentElement.scrollLeft=i.left+r*e,s.documentElement.scrollTop=i.top+a*e)},l)},E=function(t,e,o){var n=60,l=0,s=Date.now(),i=1e3/n,r=e,a=0,u=0,c=setInterval(function(){return a=u/r,a>=1?(t(1),clearInterval(c),o&&o()):(t(a),l=Math.floor(1/(.001*(Date.now()-s))),s=Date.now(),void(u+=i*(n/l)))},i)},M=function(t){var e=0,n=0;return t&&t!==o.document.body&&t!==o.document.documentElement?(e=t.scrollLeft,n=t.scrollTop):(e=o.window.scrollX||o.window.pageXOffset||o.document.documentElement.scrollLeft,n=o.window.scrollY||o.window.pageYOffset||o.document.documentElement.scrollTop),{left:e,top:n}},F=function(){var t=o.document.body,e=o.document.documentElement,n=Math.max(t.scrollWidth,t.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),l=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);return{width:n,height:l,left:0,top:0}},L=function(t){var e=t.getBoundingClientRect(),n=e.left+(o.window.scrollX||o.window.pageXOffset||o.document.documentElement.scrollLeft),l=e.top+(o.window.scrollY||o.window.pageYOffset||o.document.documentElement.scrollTop),s=e.right-e.left,i=e.bottom-e.top,r=n+.5*s,a=l+.5*i;return{left:n,top:l,width:s,height:i,center:{left:r,top:a}}},N=function(){var t=o.document.createElement("DIV");return t.style.position="absolute",t.style.display="block",t.style.width="0px",t.style.height="0px",t.style.left="0px",t.style.top="0px",t},A=function(){H(s+1)},D=function(){H(s-1)},H=function(t){if(b&&b.onBeforeGoto&&b.onBeforeGoto(o),!u){if(u=!0,(isNaN(t)||void 0===r[t])&&(t=0),i&&i.onAfterStep&&i.onAfterStep(o),i=r[t]||null,s=t,!i||!i.element)throw new Error("uiGlide: Step not found: Set: "+a+", Index: "+s);i&&i.onBeforeStep&&i.onBeforeStep(o),i&&i.title?(p.style.display="block",p.innerHTML=i.title):p.style.display="none",i&&i.desc?(h.style.display="block",h.innerHTML=i.desc):h.style.display="none",i&&i.html?(f.style.display="block",f.innerHTML=i.html):f.style.display="none",i.passthrough?(d.style.pointerEvents="none",m.style.pointerEvents="auto",g.style.pointerEvents="auto",x.style.pointerEvents="auto"):d.style.pointerEvents="auto",0>=t?m.style.display="none":m.style.display="block",t>=r.length-1?g.style.display="none":g.style.display="block";var e=parseInt(d.style.width,10),n=parseInt(d.style.height,10),l=parseInt(d.style.left,10),c=parseInt(d.style.top,10);U(),E(function(t){var o=L(i.element),s=Math.max(o.width,b.minWidth)+2*b.padding,r=Math.max(o.height,b.minHeight)+2*b.padding,a=o.center.left-.5*s,u=o.center.top-.5*r,d=F(),f=d.left+b.documentPadding,p=d.left+d.width-b.documentPadding,h=d.top+b.documentPadding,m=d.top+d.height-b.documentPadding;f>a?a=f:a+s>p&&(a-=a+s-p),h>u?u=h:u+r>m&&(u-=u+r-m);var g=C(e,s,t),x=C(n,r,t),y=C(l,a,t),B=C(c,u,t);k(y,B,g,x)},b.transition,function(){u=!1,P(),i&&i.onStep&&i.onStep(o),b&&b.onAfterGoto&&b.onAfterGoto(o)}),T(b.parent,i.element.offsetLeft-b.documentPadding,i.element.offsetTop-b.documentPadding,b.transition)}},k=function(t,e,o,n){var l=o,s=n,i=t,r=e,a=F();d.style.width=Math.max(l-2*b.borderWidth,0)+"px",d.style.height=Math.max(s-2*b.borderWidth,0)+"px",d.style.left=i+"px",d.style.top=r+"px",d.style.borderWidth=b.borderWidth+"px",y.style.width=Math.max(i,0)+"px",y.style.height=Math.max(a.height,0)+"px",y.style.left="0px",y.style.top="0px",y.style.bottom="auto",B.style.width="auto",B.style.height=Math.max(a.height,0)+"px",B.style.left=i+l+"px",B.style.right="0px",B.style.top="0px",B.style.bottom="auto",v.style.width=Math.max(l,0)+"px",v.style.height=Math.max(r,0)+"px",v.style.left=i+"px",v.style.top="0px",v.style.bottom="auto",w.style.width=Math.max(l,0)+"px",w.style.height=Math.max(a.height-(r+s),0)+"px",w.style.left=i+"px",w.style.top=r+s+"px",w.style.bottom="auto"},P=function(){var e=L(d),o=F(),n=e.top-o.top,l=o.top+o.height-(e.top+e.height),s=e.left-o.left,i=o.left+o.width-(e.left+e.width);l>=n?t(d).addClass(b.cssFocusBoxTop):t(d).addClass(b.cssFocusBoxBottom),i>=s?t(d).addClass(b.cssFocusBoxLeft):t(d).addClass(b.cssFocusBoxRight)},U=function(){for(var e=[b.cssFocusBoxLeft,b.cssFocusBoxRight,b.cssFocusBoxTop,b.cssFocusBoxBottom],o=0,n=e.length;n>o;o++)t(d).removeClass(e[o])},G=function(){if(t(o.window).off("orientationchange",Z),t(o.window).off("resize",Z),t(m).off("click",q),t(m).off("touchstart",q),t(g).off("click",J),t(g).off("touchstart",J),t(x).off("click",K),t(x).off("touchstart",K),!S())for(var e=[y,B,v,w],n=0,l=e.length;l>n;n++)t(e[n]).off("click",K),t(e[n]).off("touchstart",K);for(var s=[x,g,m,h,p,d,y,B,v,w],n=s.length-1;n>=0;n--)o.removeElement(s[n]),s[n]=null;b&&b.onAfterClose&&b.onAfterClose(o)},O=function(){b&&b.onBeforeClose&&b.onBeforeClose(o);var t=[d,y,B,v,w];E(function(e){e=1-e;for(var o=t.length-1;o>=0;o--)I(t[o],e)},b.fadeOut,G)},W=function(t){a=t||l[0].set||b.defaultSet,r=[];for(var e=0,o=l.length;o>e;e++)l[e].set==a&&r.push(l[e]);if(0==r.length)throw new Error("uiGlide: This set is empty or doesn't exist.");return z(r)},V=function(){if(d=N(),d.className=b.cssFocusBox,b.parent.appendChild(d),f=o.document.createElement("DIV"),f.innerHTML=b.htmlFocusContent,f.className=b.cssFocusContent,d.appendChild(f),p=o.document.createElement("DIV"),p.className=b.cssTitleBox,d.appendChild(p),h=o.document.createElement("DIV"),h.className=b.cssDescBox,d.appendChild(h),m=o.document.createElement("DIV"),m.className=b.cssPrevBtn,m.innerHTML=b.htmlPrevBtn,d.appendChild(m),g=o.document.createElement("DIV"),g.className=b.cssNextBtn,g.innerHTML=b.htmlNextBtn,d.appendChild(g),x=o.document.createElement("DIV"),x.className=b.cssCloseBtn,x.innerHTML=b.htmlCloseBtn,d.appendChild(x),t(m).on("click",q),t(m).on("touchstart",q),t(g).on("click",J),t(g).on("touchstart",J),t(x).on("click",K),t(x).on("touchstart",K),y=N(),y.className=b.cssLeftBox,b.parent.appendChild(y),B=N(),B.className=b.cssRightBox,b.parent.appendChild(B),v=N(),v.className=b.cssTopBox,b.parent.appendChild(v),w=N(),w.className=b.cssBottomBox,b.parent.appendChild(w),!S())for(var e=[y,B,v,w],n=0,l=e.length;l>n;n++)t(e[n]).on("click",K),t(e[n]).on("touchstart",K);t(o.window).on("orientationchange",Z),t(o.window).on("resize",Z);var s=F(),i=200,r=200,a=.5*s.width-i,u=100;k(a,u,i,r)},R=function(t,e){b&&b.onBeforeOpen&&b.onBeforeOpen(o),V(),E(function(t){I(d,t)},b.fadeIn);var n=[y,B,v,w];E(function(t){for(var e=n.length-1;e>=0;e--)I(n[e],t)},1.5*b.fadeIn),b&&b.onAfterOpen&&b.onAfterOpen(o),W(t),H(e)},j=function(){for(var e=[],n=t("["+b.dataUIStep+"]",b.parent),l=0,s=n.length,i=0,r=null,a="",u="",c="",d=null;s>l;l++)i=parseInt(t(n[l]).attr(b.dataUIStep),10),r=t(n[l]).attr(b.dataUISet),a=t(n[l]).attr(b.dataUITitle),u=t(n[l]).attr(b.dataUIDesc),c=t(n[l]).attr(b.dataUIHtml),d=t(n[l]).attr(b.dataUIPassthrough),e.push({index:i,element:n[l],set:r||b.defaultSet,title:a,desc:u,html:c,passthrough:d||b.passthrough,onBeforeStep:b.onBeforeStep,onAfterStep:b.onAfterStep,onStep:b.onStep,uiGlide:o});return e},X=function(t){for(var e=0,o=t.length;o>e;e++)t.index=e,t.set||(t.set=b.defaultSet),(void 0===t.passthrough||null===t.passthrough)&&(t.passthrough=b.passthrough),t.onBeforeStep||(t.onBeforeStep=b.onBeforeStep),t.onAfterStep||(t.onAfterStep=b.onAfterStep),t.onStep||(t.onStep=b.onStep);return t},Y=function(t){return t.sort(function(t,e){return t.set==e.set?0:+(t.set>e.set)||-1}),t},z=function(t){return t.sort(function(t,e){return t.index==e.index?0:+(t.index>e.index)||-1}),t},Q=function(e,o){for(var n=0,l=e.length;l>n;n++)o[n]&&(e[n]?e[n]=t.extend({},e[n],o[n]):e[n]=o[n]);for(var n=0,l=o.length;l>n;n++)!e[n]&&o[n]&&(e[n]=o[n]);return t.grep(e,function(t,e){return void 0!=t&&null!=t})},q=function(t){t.preventDefault(),D()},J=function(t){t.preventDefault(),A()},K=function(t){t.preventDefault(),O()},Z=function(t){clearTimeout(c),c=setTimeout(function(){H(s)},250)},$=function(){if(e&&(b=t.extend({},b,e),o.window=e.window||window,o.document=e.document||document),!b.parent||!b.parent.appendChild)throw new Error("uiGlide: Cannot append elements to the settings.parent element.");var n=j(),s=X(b.steps);l=Q(n,s),l=Y(l),R()};return o.open=R,o.close=O,o.next=A,o.prev=D,o["goto"]=H,o.getFocusBox=function(){return d},o.getSettings=function(){return b},o.getSteps=function(){return r},o.getStep=function(t){return r[t]||null},o.getCurrentSet=function(){return r},o.getCurrentSetName=function(){return a},o.getCurrentStep=function(){return i},o.getCurrentStepIndex=function(){return s},o.getVersion=function(){return n},o.window=window,o.document=document,$(),o}}(jQuery);