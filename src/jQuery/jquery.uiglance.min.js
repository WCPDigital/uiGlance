/*!
 * uiGlance v1.0.0
 * http://uiglance.com
 *
 * @author Patrick Purcell
 * @copyright Copyright (c) 2016 WCP Digital
 * @license http://opensource.org/licenses/MIT
 * @link http://www.wcpdigital.com.au
 * @link http://patrickpurcell.bio
 *
 * Date: 2016-07-25
 */
!function(t){"use strict";function e(e){var n=this,o="1.0.0",i=[],r=0,l=null,s=[],u="",a=!1,c=!1,d=null,p=null,f=null,h=null,g=null,m=null,x=null,B=null,v=null,b=null,y=null,w=null,S=null,C=null,W=null,H={parent:document.body||null,steps:[],defaultSet:"uiGlance",resetScrollbars:!0,fadeIn:1e3,fadeOut:500,documentPadding:20,transition:500,padding:10,borderWidth:1,minWidth:180,minHeight:200,maxWidth:800,maxHeight:600,passthrough:!0,dataUISet:"data-uigset",dataUIStep:"data-uigstep",dataUITitle:"data-uigtitle",dataUIDesc:"data-uigdesc",dataUIHtml:"data-uightml",dataUIPassthrough:"data-uigpassthrough",cssLeftBox:"uig-box uig-box-left",cssRightBox:"uig-box uig-box-right",cssTopBox:"uig-box uig-box-top",cssBottomBox:"uig-box uig-box-bottom",cssFocusBox:"uig-focusbox",cssFocusBoxLeft:"uig-focusbox-left",cssFocusBoxRight:"uig-focusbox-right",cssFocusBoxTop:"uig-focusbox-top",cssFocusBoxBottom:"uig-focusbox-bottom",cssFocusContent:"uig-focus-content",cssTitleBox:"uig-titlebox",cssDescBox:"uig-descbox",cssControlsBox:"uig-controlsbox",cssPrevBtn:"uig-btn uig-btn-prev",cssNextBtn:"uig-btn uig-btn-next",cssCloseBtn:"uig-btn uig-btn-close",htmlPrevBtn:'<a href="javascript:void(0)">&lt;</a>',htmlNextBtn:'<a href="javascript:void(0)">&gt;</a>',htmlCloseBtn:'<a href="javascript:void(0)">&#10006;</a>',htmlFocusContent:"",htmlControlsContent:"",onBeforeOpen:null,onAfterOpen:null,onBeforeClose:null,onAfterClose:null,onBeforeGoto:null,onAfterGoto:null,onBeforeStep:null,onAfterStep:null,onStep:null},I=function(t,e,n){return t+n*(e-t)},T=function(t,e){t.style.opacity=e;var n=100*e;t.style.filter="alpha(opacity="+n+")"},E=function(t,e,n){var o=60,i=0,r=Date.now(),l=1e3/o,s=e,u=0,a=0,c=setInterval(function(){return u=a/s,u>=1?(t(1),clearInterval(c),n&&n()):(t(u),i=Math.floor(1/(.001*(Date.now()-r))),r=Date.now(),void(a+=l*(o/i)))},l);return c},F=function(t){var e=n.document,o=n.window,i=0,r=0;return t!==e.body&&t!==e.documentElement?(i=t.scrollLeft,r=t.scrollTop):(i=o.scrollX||o.pageXOffset||e.documentElement.scrollLeft,r=o.scrollY||o.pageYOffset||e.documentElement.scrollTop),{left:i,top:r}},M=function(){var t=n.document.body,e=n.document.documentElement,o=Math.max(t.scrollWidth,t.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),i=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);return{width:o,height:i,left:0,top:0}},A=function(t){var e=n.document,o=n.window,i=t.getBoundingClientRect(),r=i.left+(o.scrollX||o.pageXOffset||e.documentElement.scrollLeft),l=i.top+(o.scrollY||o.pageYOffset||e.documentElement.scrollTop),s=i.right-i.left,u=i.bottom-i.top,a=r+.5*s,c=l+.5*u;return{left:r,top:l,width:s,height:u,center:{left:a,top:c}}},G=function(t,e){var o=n.document;n.window;if(e==o.body||e==o.documentElement)return A(t);var i=F(e),r=e.getBoundingClientRect(),l=t.getBoundingClientRect(),s=l.left-r.left+i.left,u=l.top-r.top+i.top,a=l.right-l.left,c=l.bottom-l.top,d=s+.5*a,p=u+.5*c;return{left:s,top:u,width:a,height:c,center:{left:d,top:p}}},P=function(t,e,o,i){var r=n.document.createElement("DIV");return r.innerHTML=t||"",r.className=e||"",o&&o.appendChild&&o.appendChild(r),i&&(r.style.position="absolute",r.style.display="block",r.style.width="0px",r.style.height="0px",r.style.left="0px",r.style.top="0px"),r},L=function(){O(r+1)},U=function(){O(r-1)},O=function(t){if(H&&H.onBeforeGoto&&H.onBeforeGoto(n),d&&k(),(isNaN(t)||void 0===s[t])&&(t=0),l&&l.onAfterStep&&l.onAfterStep(n),l=s[t]||null,r=t,!l||!l.element)throw new Error("uiGlance: Step not found: Set: "+s+", Index: "+r);l&&l.onBeforeStep&&l.onBeforeStep(n),l&&l.title?(m.style.display="block",m.innerHTML=l.title):m.style.display="none",l&&l.desc?(x.style.display="block",x.innerHTML=l.desc):x.style.display="none",l.passthrough?(h.style.pointerEvents="none",B.style.pointerEvents="none",v.style.pointerEvents="auto",b.style.pointerEvents="auto",y.style.pointerEvents="auto"):(h.style.pointerEvents="auto",B.style.pointerEvents="auto"),g.innerHTML=l.html,h.style.borderWidth=l.borderWidth+"px",0>=t?v.style.display="none":v.style.display="block",t>=s.length-1?b.style.display="none":b.style.display="block";var e=G(h,H.parent),o=(parseInt(h.style.width,10),parseInt(h.style.height,10),parseInt(h.style.left,10),parseInt(h.style.top,10),F(H.parent));return j(l),d=E(function(t){var n=G(l.element,H.parent),i=2*l.padding,r=2*l.borderWidth,s=Math.max(n.width+i-r,l.minWidth),u=Math.max(n.height+i-r,l.minHeight);s=Math.min(s+i-r,l.maxWidth),u=Math.min(u+i-r,l.maxHeight);var a=n.center.left-.5*s,c=n.center.top-.5*u,d=M(),p={left:d.left+H.documentPadding,right:d.left+d.width-H.documentPadding,top:d.top+H.documentPadding,bottom:d.top+d.height-H.documentPadding};p.left>a&&(a+=p.left-a),p.right<a+s&&(s-=a+s-p.right),p.top>c&&(c+=p.top-c),p.bottom<c+u&&(u-=c+u-p.bottom);var f=I(e.left,a,t),h=I(e.top,c,t),g=I(e.width,s,t),m=I(e.height,u,t);R(f,h,g,m);var x=a-H.documentPadding,B=c-H.documentPadding,v=I(o.left,x,t),b=I(o.top,B,t);D(v-H.documentPadding,b-H.documentPadding)},l.transition,function(){k(),Y(l),l&&l.onStep&&l.onStep(n),H&&H.onAfterGoto&&H.onAfterGoto(n)}),n},k=function(){return clearInterval(d),d=null,n},D=function(t,e){var o=n.document,i=H.parent||null,r=i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth;r&&i&&i!==o.body&&i!==o.documentElement?(i.scrollLeft=t,i.scrollTop=e):(o.documentElement.scrollLeft=o.body.scrollLeft=t,o.documentElement.scrollTop=o.body.scrollTop=e)},N=function(t,e,n,o,i,r,l){t.style.width=e,t.style.height=n,t.style.left=o,t.style.top=i,t.style.right=r,t.style.bottom=l},R=function(t,e,n,o){var i=n,r=o,l=t,s=e,u=M();N(h,Math.max(i,0)+"px",Math.max(r,0)+"px",l+"px",s+"px","auto","auto"),N(B,Math.max(i,0)+"px",Math.max(r,0)+"px",l+"px",s+"px","auto","auto"),N(w,Math.max(l,0)+"px",Math.max(u.height,0)+"px","0px","0px","auto","auto"),N(S,"auto",Math.max(u.height,0)+"px",l+i+"px","0px","0px","auto"),N(C,Math.max(i,0)+"px",Math.max(s,0)+"px",l+"px","0px","auto","auto"),N(W,Math.max(i,0)+"px",Math.max(u.height-(s+r),0)+"px",l+"px",s+r+"px","auto","auto")},Y=function(e){var n=G(h,H.parent),o=M(),i=n.top-o.top,r=o.top+o.height-(n.top+n.height),l=n.left-o.left,s=o.left+o.width-(n.left+n.width),u="";u=r>=i?e.cssFocusBoxTop||H.cssFocusBoxTop:e.cssFocusBoxTop||H.cssFocusBoxBottom,t(h).addClass(u),u=s>=l?e.cssFocusBoxTop||H.cssFocusBoxLeft:e.cssFocusBoxTop||H.cssFocusBoxRight,t(h).addClass(u)},j=function(t){h.className=t.cssFocusBox||H.cssFocusBox},z=function(){t(n.window).off("orientationchange",ot),t(n.window).off("resize",ot),t(H.parent).off("orientationchange",ot),t(H.parent).off("resize",ot),t(v).off("click",tt),t(v).off("touchstart",tt),t(b).off("click",et),t(b).off("touchstart",et),t(y).off("click",nt),t(y).off("touchstart",nt);for(var e=[y,b,v,x,m,h,B,w,S,C,W],o=e.length-1;o>=0;o--)t(e[o]).remove(),e[o]=null;H&&H.onAfterClose&&H.onAfterClose(n),c=!1},X=function(){if(a)throw new Error("uiGlance: Tried to close before completing the opening.");c=!0,H&&H.onBeforeClose&&H.onBeforeClose(n),d&&k();var t=[h,B,w,S,C,W],e=F(H.parent);return E(function(n){if(H.resetScrollbars){var o=I(e.left,f.left,n),i=I(e.top,f.top,n);D(o,i)}n=1-n;for(var r=t.length-1;r>=0;r--)T(t[r],n)},H.fadeOut,z),n},V=function(t){u=t||i[0]&&i[0].set||H.defaultSet,s=[];for(var e=0,n=i.length;n>e;e++)i[e].set==u&&s.push(i[e]);if(0==s.length)throw new Error("uiGlance: This set is empty or doesn't exist.");return $(s)},Q=function(){w=P(null,H.cssLeftBox,H.parent,!0),S=P(null,H.cssRightBox,H.parent,!0),C=P(null,H.cssTopBox,H.parent,!0),W=P(null,H.cssBottomBox,H.parent,!0),h=P(null,null,H.parent,!0),g=P(H.htmlFocusContent,H.cssFocusContent,h),m=P(null,H.cssTitleBox,h),x=P(null,H.cssDescBox,h),B=P(H.htmlControlsContent,H.cssControlsBox,H.parent,!0),v=P(H.htmlPrevBtn,H.cssPrevBtn,B),b=P(H.htmlNextBtn,H.cssNextBtn,B),y=P(H.htmlCloseBtn,H.cssCloseBtn,B),t(v).on("click",tt),t(v).on("touchstart",tt),t(b).on("click",et),t(b).on("touchstart",et),t(y).on("click",nt),t(y).on("touchstart",nt),t(H.parent).on("orientationchange",ot),t(H.parent).on("resize",ot),t(n.window).on("orientationchange",ot),t(n.window).on("resize",ot);var e=M(),o=200,i=200,r=.5*e.width-o,l=100;R(r,l,o,i)},q=function(t,e){if(c)throw new Error("uiGlance: Tried to open before completing the close.");if(h)throw new Error("uiGlance: You can only open one glide at a time.");a=!0,H&&H.onBeforeOpen&&H.onBeforeOpen(n),V(e),f=F(H.parent),Q(),E(function(t){T(h,t),T(B,t)},H.fadeIn);var o=[w,S,C,W];return E(function(t){for(var e=o.length-1;e>=0;e--)T(o[e],t)},1.5*H.fadeIn),H&&H.onAfterOpen&&H.onAfterOpen(n),a=!1,O(t)},J=function(){for(var e=[],o=t("["+H.dataUIStep+"]",H.parent),i=0,r=o.length,l=0,s=null,u="",a="",c="",d=null;r>i;i++)l=parseInt(t(o[i]).attr(H.dataUIStep),10),s=t(o[i]).attr(H.dataUISet),u=t(o[i]).attr(H.dataUITitle),a=t(o[i]).attr(H.dataUIDesc),c=t(o[i]).attr(H.dataUIHtml),d=t(o[i]).attr(H.dataUIPassthrough),e.push({index:l,element:o[i],title:u,desc:a,transition:H.transition,minWidth:H.minWidth,minHeight:H.minHeight,maxWidth:H.maxWidth,maxHeight:H.maxHeight,borderWidth:H.borderWidth,padding:H.padding,onBeforeStep:H.onBeforeStep,onAfterStep:H.onAfterStep,onStep:H.onStep,set:s||H.defaultSet,html:c||H.htmlFocusContent,passthrough:d||H.passthrough,uiGlance:n});return e},K=function(t){for(var e=0,n=t.length;n>e;e++)t.index=e,t.set||(t.set=H.defaultSet),t.html||(t.html=H.htmlFocusContent),t.transition||(t.transition=H.transition),t.minWidth||(t.minWidth=H.minWidth),t.minHeight||(t.minHeight=H.minHeight),t.maxWidth||(t.maxWidth=H.maxWidth),t.maxHeight||(t.maxHeight=H.maxHeight),(void 0===t.padding||null===t.padding)&&(t.padding=H.padding),(void 0===t.borderWidth||null===t.borderWidth)&&(t.borderWidth=H.borderWidth),(void 0===t.passthrough||null===t.passthrough)&&(t.passthrough=H.passthrough),t.onBeforeStep||(t.onBeforeStep=H.onBeforeStep),t.onAfterStep||(t.onAfterStep=H.onAfterStep),t.onStep||(t.onStep=H.onStep);return t},Z=function(t){return t.sort(function(t,e){return t.set==e.set?0:+(t.set>e.set)||-1}),t},$=function(t){return t.sort(function(t,e){return t.index==e.index?0:+(t.index>e.index)||-1}),t},_=function(e,n){for(var o=0,i=e.length;i>o;o++)n[o]&&(e[o]?e[o]=t.extend({},e[o],n[o]):e[o]=n[o]);for(var o=0,i=n.length;i>o;o++)!e[o]&&n[o]&&(e[o]=n[o]);return t.grep(e,function(t,e){return void 0!=t&&null!=t})},tt=function(t){t.preventDefault(),U()},et=function(t){t.preventDefault(),L()},nt=function(t){t.preventDefault(),X()},ot=function(t){clearTimeout(p),p=setTimeout(function(){O(r)},250)},it=function(){if(e&&(H=t.extend({},H,e),H.parent=H.parent||document.body,n.window=e.window||window,n.document=e.document||document),!H.parent||!H.parent.appendChild)throw new Error("uiGlance: Cannot append elements to the settings.parent element.");var o=J(),r=K(H.steps);i=_(o,r),i=Z(i)};n.open=q,n.close=X,n.next=L,n.prev=U,n["goto"]=O,n.stop=k,n.getFocusBox=function(){return h},n.getSettings=function(){return H},n.getSteps=function(){return s},n.getStep=function(t){return s[t]||null},n.getCurrentSet=function(){return s},n.getCurrentSetName=function(){return u},n.getCurrentStep=function(){return l},n.getCurrentStepIndex=function(){return r},n.getVersion=function(){return o},n.window=window,n.document=document,it()}t.uiGlance=function(t){return new e(t)},t.fn.uiGlance=function(n){return n=n||{},n.parent=t(this)[0]||null,new e(n)}}(jQuery);