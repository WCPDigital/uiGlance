/*!
 * uiGlide v1.0.0
 * http://uiglide.com
 *
 * Copyright WCP Digital and Patrick Purcell
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 * Date: 2016-07-25
 */
"use strict";function uiGlide(t){var e=this,n="1.0.0",o=[],l=0,i=null,s=[],r="",a=!1,u=null,c=null,d=null,p=null,h=null,f=null,m=null,g=null,v=null,y=null,x=null,w=null,E={parent:document.body||null,steps:[],defaultSet:"uiGlide",transition:.5,fadeIn:1,fadeOut:.5,minWidth:260,minHeight:125,padding:10,borderWidth:2,documentPadding:20,dataUISet:"data-uigset",dataUIStep:"data-uigstep",dataUITitle:"data-uigtitle",dataUIDesc:"data-uigdesc",dataUIHtml:"data-uightml",cssLeftBox:"uig-box uig-box-left",cssRightBox:"uig-box uig-box-right",cssTopBox:"uig-box uig-box-top",cssBottomBox:"uig-box uig-box-bottom",cssFocusBox:"uig-focusbox",cssFocusBoxLeft:"uig-focusbox-left",cssFocusBoxRight:"uig-focusbox-right",cssFocusBoxTop:"uig-focusbox-top",cssFocusBoxBottom:"uig-focusbox-bottom",cssFocusContent:"uig-focus-content",cssTitleBox:"uig-titlebox",cssDescBox:"uig-descbox",cssPrevBtn:"uig-btn uig-btn-prev",cssNextBtn:"uig-btn uig-btn-next",cssCloseBtn:"uig-btn uig-btn-close",htmlPrevBtn:'<a href="javascript:void(0)">&lt;</a>',htmlNextBtn:'<a href="javascript:void(0)">&gt;</a>',htmlCloseBtn:'<a href="javascript:void(0)">&#10006;</a>',htmlFocusContent:"<div></div>",onBeforeOpen:null,onAfterOpen:null,onBeforeClose:null,onAfterClose:null,onBeforeGoto:null,onAfterGoto:null},B=function(){var t=e.document.createElement("DIV");return t.style.position="absolute",t.style.display="block",t.style.width="0px",t.style.height="0px",t.style.left="0px",t.style.top="0px",t},b=function(){T(l+1)},C=function(){T(l-1)},T=function(t){if(E&&E.onBeforeGoto&&E.onBeforeGoto(e),!a){if(a=!0,(isNaN(t)||void 0===s[t])&&(t=0),i&&i.onAfterStep&&i.onAfterStep(e),i=s[t]||null,l=t,!i||!i.element)throw new Error("uiGlide: Step not found: Set: "+s+", Index: "+l);i&&i.onBeforeStep&&i.onBeforeStep(e),i&&i.title?(p.style.display="block",p.innerHTML=i.title):p.style.display="none",i&&i.desc?(h.style.display="block",h.innerHTML=i.desc):h.style.display="none",i&&i.html?(d.style.display="block",d.innerHTML=i.html):d.style.display="none",0>=t?f.style.display="none":f.style.display="block",t>=s.length-1?m.style.display="none":m.style.display="block";var n=parseInt(c.style.width,10),o=parseInt(c.style.height,10),r=parseInt(c.style.left,10),u=parseInt(c.style.top,10);I(),e.animate(function(t){var l=e.getElementRect(i.element),s=Math.max(l.width,E.minWidth)+2*E.padding,a=Math.max(l.height,E.minHeight)+2*E.padding,c=l.center.left-.5*s,d=l.center.top-.5*a,p=e.documentOutterRect(),h=p.left+e.documentPadding,f=p.left+p.width-e.documentPadding,m=p.top+e.documentPadding,g=p.top+p.height-e.documentPadding;h>c?c=h:c+s>f&&(c-=c+s-f),m>d?d=m:d+a>g&&(d-=d+a-g);var v=e.lerp(n,s,t),y=e.lerp(o,a,t),x=e.lerp(r,c,t),w=e.lerp(u,d,t);G(x,w,v,y)},E.transition,function(){a=!1,S(),i&&i.onStep&&i.onStep(e),E&&E.onAfterGoto&&E.onAfterGoto(e)}),e.scrollTo(E.parent,i.element.offsetLeft-E.documentPadding,i.element.offsetTop-E.documentPadding,E.transition)}},G=function(t,n,o,l){var i=o,s=l,r=t,a=n,u=e.documentOutterRect();c.style.width=Math.abs(i-2*E.borderWidth)+"px",c.style.height=Math.abs(s-2*E.borderWidth)+"px",c.style.left=r+"px",c.style.top=a+"px",c.style.borderWidth=E.borderWidth+"px",v.style.width=r+"px",v.style.height=u.height+"px",v.style.left="0px",v.style.top="0px",v.style.bottom="auto",y.style.width="auto",y.style.height=u.height+"px",y.style.left=r+i+"px",y.style.right="0px",y.style.top="0px",y.style.bottom="auto",x.style.width=i+"px",x.style.height=a+"px",x.style.left=r+"px",x.style.top="0px",x.style.bottom="auto",w.style.width=i+"px",w.style.height=Math.abs(u.height-(a+s))+"px",w.style.left=r+"px",w.style.top=a+s+"px",w.style.bottom="auto"},S=function(){var t=e.getElementRect(c),n=e.documentOutterRect(),o=t.top-n.top,l=n.top+n.height-(t.top+t.height),i=t.left-n.left,s=n.left+n.width-(t.left+t.width);console.log(o+", "+l),l>=o?e.addClass(c,E.cssFocusBoxTop):e.addClass(c,E.cssFocusBoxBottom),console.log(i+", "+s),s>=i?e.addClass(c,E.cssFocusBoxLeft):e.addClass(c,E.cssFocusBoxRight)},I=function(){for(var t=[E.cssFocusBoxLeft,E.cssFocusBoxRight,E.cssFocusBoxTop,E.cssFocusBoxBottom],n=0,o=t.length;o>n;n++)e.removeClass(c,t[n])},A=function(){if(e.removeEvent(e.window,"orientationchange",U),e.removeEvent(e.window,"resize",U),e.removeEvent(f,"click",R),e.removeEvent(f,"touchstart",R),e.removeEvent(m,"click",V),e.removeEvent(m,"touchstart",V),e.removeEvent(g,"click",W),e.removeEvent(g,"touchstart",W),!e.isTouchDevice())for(var t=[v,y,x,w],n=0,o=t.length;o>n;n++)e.removeEvent(t[n],"click",W),e.removeEvent(t[n],"touchstart",W);for(var l=[g,m,f,h,p,c,v,y,x,w],n=l.length-1;n>=0;n--)e.removeElement(l[n]),l[n]=null;E&&E.onAfterClose&&E.onAfterClose(e)},N=function(){E&&E.onBeforeClose&&E.onBeforeClose(e);var t=[c,v,y,x,w];e.animate(function(n){n=1-n;for(var o=t.length-1;o>=0;o--)e.opacity(t[o],n)},E.fadeOut,A)},O=function(t){r=t||o[0].set||E.defaultSet,s=[];for(var e=0,n=o.length;n>e;e++)o[e].set==r&&s.push(o[e]);if(0==s.length)throw new Error("uiGlide: This set is empty or doesn't exist.");return P(s)},D=function(){if(c=B(),c.className=E.cssFocusBox,E.parent.appendChild(c),d=e.document.createElement("DIV"),d.innerHTML=E.htmlFocusContent,d.className=E.cssFocusContent,c.appendChild(d),p=e.document.createElement("DIV"),p.className=E.cssTitleBox,c.appendChild(p),h=e.document.createElement("DIV"),h.className=E.cssDescBox,c.appendChild(h),f=e.document.createElement("DIV"),f.className=E.cssPrevBtn,f.innerHTML=E.htmlPrevBtn,c.appendChild(f),m=e.document.createElement("DIV"),m.className=E.cssNextBtn,m.innerHTML=E.htmlNextBtn,c.appendChild(m),g=e.document.createElement("DIV"),g.className=E.cssCloseBtn,g.innerHTML=E.htmlCloseBtn,c.appendChild(g),e.addEvent(f,"click",R),e.addEvent(f,"touchstart",R),e.addEvent(m,"click",V),e.addEvent(m,"touchstart",V),e.addEvent(g,"click",W),e.addEvent(g,"touchstart",W),v=B(),v.className=E.cssLeftBox,E.parent.appendChild(v),y=B(),y.className=E.cssRightBox,E.parent.appendChild(y),x=B(),x.className=E.cssTopBox,E.parent.appendChild(x),w=B(),w.className=E.cssBottomBox,E.parent.appendChild(w),!e.isTouchDevice())for(var t=[v,y,x,w],n=0,o=t.length;o>n;n++)e.addEvent(t[n],"click",W),e.addEvent(t[n],"touchstart",W);e.addEvent(e.window,"orientationchange",U),e.addEvent(e.window,"resize",U);var l=e.documentOutterRect(),i=200,s=200,r=.5*l.width-i,a=100;G(r,a,i,s)},L=function(t,n){E&&E.onBeforeOpen&&E.onBeforeOpen(e),D(),e.animate(function(t){e.opacity(c,t)},E.fadeIn);var o=[v,y,x,w];e.animate(function(t){for(var n=o.length-1;n>=0;n--)e.opacity(o[n],t)},1.5*E.fadeIn),E&&E.onAfterOpen&&E.onAfterOpen(e),O(t),T(n)},F=function(){for(var t=[],n=e.getElementByAttrValue(E.dataUIStep,null,E.parent),o=0,l=n.length,i=0,s=null,r="",a="",u="";l>o;o++)i=parseInt(e.getAttr(n[o],E.dataUIStep),10),s=e.getAttr(n[o],E.dataUISet)||E.defaultSet,r=e.getAttr(n[o],E.dataUITitle),a=e.getAttr(n[o],E.dataUIDesc),u=e.getAttr(n[o],E.dataUIHtml),t.push({index:i,element:n[o],set:s,title:r,desc:a,html:u,onBeforeStep:null,onAfterStep:null,onStep:null,uiGlide:e});return t},H=function(t){for(var e=0,n=t.length;n>e;e++)t.index=e,t.set||(t.set=E.defaultSet);return t},k=function(t){return t.sort(function(t,e){return t.set==e.set?0:+(t.set>e.set)||-1}),t},P=function(t){return t.sort(function(t,e){return t.index==e.index?0:+(t.index>e.index)||-1}),t},M=function(t,n){for(var o=0,l=t.length;l>o;o++)n[o]&&(t[o]?t[o]=e.wash(t[o],n[o]):t[o]=n[o]);for(var o=0,l=n.length;l>o;o++)!t[o]&&n[o]&&(t[o]=n[o]);return e.arrayClean(t)},R=function(t){var n=e.normaliseEvent(t);n.preventDefault(),C()},V=function(t){var n=e.normaliseEvent(t);n.preventDefault(),b()},W=function(t){var n=e.normaliseEvent(t);n.preventDefault(),N()},U=function(t){clearTimeout(u),u=setTimeout(function(){T(l)},250)},X=function(){if(t&&(E=e.wash(E,t),e.window=t.window||window,e.document=t.document||document),!E.parent||!E.parent.appendChild)throw new Error("uiGlide: Cannot append elements to the settings.parent element.");var n=F(),l=H(E.steps);o=M(n,l),o=k(o)};e.open=L,e.close=N,e.next=b,e.prev=C,e["goto"]=T,e.getFocusBox=function(){return c},e.getSettings=function(){return E},e.getSteps=function(){return s},e.getStep=function(t){return s[t]||null},e.getCurrentSet=function(){return s},e.getCurrentSetName=function(){return r},e.getCurrentStep=function(){return i},e.getCurrentStepIndex=function(){return l},e.getVersion=function(){return n},e.window=window,e.document=document,X()}uiGlide.prototype.constructor=uiGlide,uiGlide.prototype.lerp=function(t,e,n){return t+n*(e-t)},uiGlide.prototype.isTouchDevice=function(){return"ontouchstart"in window||navigator.maxTouchPoints},uiGlide.prototype.arrayClean=function(t){for(var e=[],n=0,o=t.length;o>n;n++)t[n]&&e.push(t[n]);return e},uiGlide.prototype.wash=function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(t[n]=e[n]);return t},uiGlide.prototype.scrollOffset=function(t){var e=0,n=0;return t&&t!==this.document.body&&t!==this.document.documentElement?(e=t.scrollLeft,n=t.scrollTop):(e=this.window.scrollX||this.window.pageXOffset||this.document.documentElement.scrollLeft,n=this.window.scrollY||this.window.pageYOffset||this.document.documentElement.scrollTop),{left:e,top:n}},uiGlide.prototype.getScrollingElement=function(){var t=this.document;return t.documentElement.scrollHeight>t.body.scrollHeight&&0==t.compatMode.indexOf("CSS1")?t.documentElement:t.body},uiGlide.prototype.documentOutterRect=function(){var t=this.document.body,e=this.document.documentElement,n=Math.max(t.scrollWidth,t.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),o=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);return{width:n,height:o,left:0,top:0}},uiGlide.prototype.getElementRect=function(t){var e=t.getBoundingClientRect(),n=e.left+(this.window.scrollX||this.window.pageXOffset||this.document.documentElement.scrollLeft),o=e.top+(this.window.scrollY||this.window.pageYOffset||this.document.documentElement.scrollTop),l=e.right-e.left,i=e.bottom-e.top,s=n+.5*l,r=o+.5*i;return{left:n,top:o,width:l,height:i,center:{left:s,top:r}}},uiGlide.prototype.removeElement=function(t){return t&&t.parentElement&&t.parentElement.removeChild(t),t=null},uiGlide.prototype.hasClass=function(t,e){return t&&!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},uiGlide.prototype.addClass=function(t,e){this.hasClass(t,e)||(t.className+=" "+e)},uiGlide.prototype.removeClass=function(t,e){if(this.hasClass(t,e)){var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ").trim()}},uiGlide.prototype.getElementByAttrValue=function(t,e,n,o){n=n||this.document;var l=null!=e?"["+t+"='"+e+"']":"["+t+"]",i=n.querySelectorAll&&n.querySelectorAll(l)||null;if(!i)for(var s=null,r=0,i=[],a=n.getElementsByTagName("*");s=a[r++];){var u=this.getAttr(s,t);null==e&&u?i.push(s):null!=e&&u==e&&i.push(s)}return o?i[0]||null:i},uiGlide.prototype.getAttr=function(t,e){var n=t.getAttribute&&t.getAttribute(e)||null;if(!n)for(var o=t.attributes||[],l=o.length,i=0;l>i;i++)o[i].nodeName===e&&(n=o[i].nodeValue);return n},uiGlide.prototype.addEvent=function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n),t},uiGlide.prototype.removeEvent=function(t,e,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,n),t},uiGlide.prototype.normaliseEvent=function(t){if(t=t||this.window.event){var e=t.type,n=t.currentTarget||t.srcElement,o=function(){t.preventDefault?t.preventDefault():t.returnValue=!1},l=function(){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},i=t.touches,s=t.which||{};null!=t.which||null==t.charCode&&null==t.keyCode||(s=null!=t.charCode?t.charCode:t.keyCode);var r=t.which||{};null==t.which&&void 0!==t.button&&(r=1&t.button?1:2&t.button?3:4&t.button?2:0),null!=i&&(r=i.length>1?3:1);var a=this.window.scrollX||this.window.pageXOffset||this.document.documentElement.scrollLeft,u=this.window.scrollY||this.window.pageYOffset||this.document.documentElement.scrollTop,c=0,d=0;return t.changedTouches?(c=t.changedTouches[0].clientX||0,d=t.changedTouches[0].clientY||0):(c=t.clientX||t.pageX||0,d=t.clientY||t.pageY||0),c+=a,d+=u,{event:t,element:n,type:e,key:s,which:r,touches:i,top:d,left:c,preventDefault:o,stopPropagation:l}}return null},uiGlide.prototype.scrollTo=function(t,e,n,o){var l=this;o=o||0,t&&t!=this.document.body&&t!=this.document.documentElement||(t=l.getScrollingElement());var i=l.scrollOffset(t),s=(e||0)-i.left,r=(n||0)-i.top;this.animate(function(e){t.scrollLeft=i.left+s*e,t.scrollTop=i.top+r*e},o)},uiGlide.prototype.animate=function(t,e,n){var o=60,l=0,i=Date.now(),s=1e3/o,r=1e3*e,a=0,u=0,c=setInterval(function(){return a=u/r,a>=1?(t(1),clearInterval(c),n&&n()):(t(a),l=Math.floor(1/(.001*(Date.now()-i))),i=Date.now(),void(u+=s*(o/l)))},s)},uiGlide.prototype.opacity=function(t,e){t.style.opacity=e;var n=100*e;t.style.filter="alpha(opacity="+n+")"};